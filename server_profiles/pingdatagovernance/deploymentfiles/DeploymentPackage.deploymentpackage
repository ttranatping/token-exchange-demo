[{"class":"Package","id":"2eeb3243-6c33-4687-8cc4-a10273c3f5ca","name":"issuer changes","deploymentPackageVersion":1,"applicationName":"Symphonic admin-point-application","applicationVersion":"9.0.2.0-GA","dateCreated":"2022-08-18T02:32:23.944512Z","createdBy":"admin","snapshotId":"3119d017-9a1d-4e45-9326-1177ca1e5b2c","snapshotMessage":"Adding issuer to evaluate token exchange","snapshotDateCommitted":"2022-08-18T02:31:24.732637Z","rootEntityId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","rootEntityName":"Global Decision Point","enabledFeatures":[],"customProperties":{}},{"class":"Metadata","originType":"Policy","originId":"5aac7b0b-ba8b-49bc-aa50-7aa793da91ef","name":"SendATPolicy","properties":{},"disabled":false,"repetitionSettings":null},{"class":"AlwaysTrueNode","id":"4c526b0b-d781-357a-a6ef-0cd18062e00d"},{"class":"CombinedDecisionNode","id":"0ee7fce6-5fbb-3710-b86a-aeeb2bd7426b","combiningAlgorithm":{"name":"PermitUnlessDeny"},"inputNodes":[],"inputNodeWeights":[],"guardNode":"4c526b0b-d781-357a-a6ef-0cd18062e00d","originLink":"5aac7b0b-ba8b-49bc-aa50-7aa793da91ef"},{"class":"AttributeDefinition","id":"a007b39b-33ca-436c-977f-21a4831daa96","name":"HttpRequest","resolvers":[{"class":"request","condition":null,"expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"4d1cabb6-692d-45f1-8c25-7443163c3be6","name":"HttpRequest.Headers","resolvers":[{"class":"attribute","attributeDefinitionId":"a007b39b-33ca-436c-977f-21a4831daa96","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"jsonPath","id":null,"name":null,"valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"Headers"}]}},{"type":"coerce","valueType":"JSON"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"41754fe3-8dee-4ee5-82b0-094d62aa5b92","name":"HttpRequest.Headers.Authorization","resolvers":[{"class":"attribute","attributeDefinitionId":"4d1cabb6-692d-45f1-8c25-7443163c3be6","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"jsonPath","id":null,"name":null,"valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"$.Authorization"}]}},{"type":"coerce","valueType":"COLLECTION"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"36d9b9b1-1299-43e2-a290-021e8245dfad","name":"HttpRequest.Headers.Token","resolvers":[{"class":"attribute","attributeDefinitionId":"4d1cabb6-692d-45f1-8c25-7443163c3be6","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"SpEL","id":null,"name":null,"valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"Interpolation","hole":"41754fe3-8dee-4ee5-82b0-094d62aa5b92","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"[0].replace(\"Bearer \", \"\")"}]}},{"type":"coerce","valueType":"STRING"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"56c095e6-d8f0-41c8-884c-d6d9654a782a","name":"HttpRequest.Headers.Token.contentEncoded","resolvers":[{"class":"attribute","attributeDefinitionId":"36d9b9b1-1299-43e2-a290-021e8245dfad","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"SpEL","id":null,"name":"Get issuer from token","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"#this.split(\"\\.\")[1]"}]}},{"type":"coerce","valueType":"STRING"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"2319f209-651e-4864-884e-cc5341a5b449","name":"HttpRequest.Headers.Token.contentEncoded.contentJSONObject","resolvers":[{"class":"attribute","attributeDefinitionId":"56c095e6-d8f0-41c8-884c-d6d9654a782a","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"SpEL","id":null,"name":"Get JSON From encoded content","valueType":"JSON","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"new String((T(java.util.Base64).getDecoder().decode(#this)))"}]}},{"type":"coerce","valueType":"JSON"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"7b25b435-a7b6-4ff0-beda-0d8bfa189c06","name":"HttpRequest.Headers.Token.contentEncoded.contentJSONObject.issuer","resolvers":[{"class":"attribute","attributeDefinitionId":"2319f209-651e-4864-884e-cc5341a5b449","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":null,"cacheTimeToLive":0,"cacheStrategy":"NO_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"jsonPath","id":null,"name":"get issuer","valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"iss"}]}},{"type":"coerce","valueType":"STRING"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"ServiceDefinition","id":"b747a2e8-d9d9-48ec-a811-977129cb18aa","name":"PingFederate Token Endpoint","serviceSettings":{"class":"rest","urlFormat":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"https://pingfederate:9031/as/token.oauth2"}]},"body":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"client_id=tokenexchange&client_secret=2FederateM0re&subject_token="},{"@class":"Interpolation","hole":"36d9b9b1-1299-43e2-a290-021e8245dfad","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"&subject_token_type="},{"@class":"Interpolation","hole":"7b25b435-a7b6-4ff0-beda-0d8bfa189c06","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"&grant_type=urn:ietf:params:oauth:grant-type:token-exchange"}]},"verb":"POST","contentType":"application/x-www-form-urlencoded","headers":[],"authenticationType":"NONE","authenticationAttributes":{"@class":"MapTemplate","map":{}},"tlsSettings":{"@class":"TlsSettings","tlsValidationType":"NONE","tlsTruststore":null,"mtlsValidation":false,"mtlsKeystore":null}},"expression":{"type":"coerce","valueType":"STRING"},"properties":{},"serviceResilience":{"maximumConcurrentRequests":2,"maximumRequestsPerSecond":1000000.0,"timeoutMilliseconds":2000,"maximumRetryCount":2,"holdoffMilliseconds":1000,"retryStrategy":"FIXED","retryJitter":10.0},"secret":false},{"class":"AttributeDefinition","id":"5a7c5699-da65-45f1-8112-e6d7b21b59bc","name":"TokenExchange","resolvers":[{"class":"service","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null,"serviceDefinitionId":"b747a2e8-d9d9-48ec-a811-977129cb18aa"}],"defaultValue":null,"cacheScopeAttributeId":"41754fe3-8dee-4ee5-82b0-094d62aa5b92","cacheTimeToLive":60,"cacheStrategy":"SCOPE_EXPIRE_CACHING","isSecret":false,"expression":{"type":"coerce","valueType":"JSON"},"properties":{},"repetitionSourceAttributeId":null},{"class":"AttributeDefinition","id":"38944753-d9a5-480d-9725-5ef079e860db","name":"TokenExchange.access_token","resolvers":[{"class":"attribute","attributeDefinitionId":"5a7c5699-da65-45f1-8112-e6d7b21b59bc","condition":"4c526b0b-d781-357a-a6ef-0cd18062e00d","expression":null}],"defaultValue":null,"cacheScopeAttributeId":"41754fe3-8dee-4ee5-82b0-094d62aa5b92","cacheTimeToLive":60,"cacheStrategy":"SCOPE_EXPIRE_CACHING","isSecret":false,"expression":{"type":"chain","expressions":[{"type":"jsonPath","id":null,"name":null,"valueType":"STRING","expression":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"access_token"}]}},{"type":"coerce","valueType":"STRING"}]},"properties":{},"repetitionSourceAttributeId":null},{"class":"StatementTemplate","id":"6912b305-37a7-4343-a1d1-039a6e636ba0","name":"Update Authorization Header","code":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"modify-headers"}]},"payload":{"@class":"JoiningTemplate","components":[{"@class":"FixedTemplate","x":"{\"Authorization\": \"Bearer "},{"@class":"Interpolation","hole":"38944753-d9a5-480d-9725-5ef079e860db","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"\", \"issuer\":\""},{"@class":"Interpolation","hole":"7b25b435-a7b6-4ff0-beda-0d8bfa189c06","safelyInterpolatable":false},{"@class":"FixedTemplate","x":"\"}"}]},"obligatory":false,"appliesTo":"ANYTHING","attributes":{},"services":{}},{"class":"StatementNode","id":"8992ec9e-0d9b-3531-97e5-2cbae700e80d","inputNode":"0ee7fce6-5fbb-3710-b86a-aeeb2bd7426b","metadataId":"5aac7b0b-ba8b-49bc-aa50-7aa793da91ef","statements":["6912b305-37a7-4343-a1d1-039a6e636ba0"]},{"class":"TargetMatchNode","id":"0f4954c2-de82-36ea-beaf-fe15a9edcf69","inputNode":"8992ec9e-0d9b-3531-97e5-2cbae700e80d","metadataId":"5aac7b0b-ba8b-49bc-aa50-7aa793da91ef","targets":[]},{"class":"Metadata","originType":"PolicySet","originId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","name":"Global Decision Point","properties":{},"disabled":false,"repetitionSettings":null},{"class":"CombinedDecisionNode","id":"aef7c0b0-2046-3c71-ba04-09a8361d3dd2","combiningAlgorithm":{"name":"PermitUnlessDeny"},"inputNodes":["0f4954c2-de82-36ea-beaf-fe15a9edcf69"],"inputNodeWeights":[100],"guardNode":"4c526b0b-d781-357a-a6ef-0cd18062e00d","originLink":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1"},{"class":"StatementNode","id":"195a4420-d2f9-3557-ba26-69c3f585e1fa","inputNode":"aef7c0b0-2046-3c71-ba04-09a8361d3dd2","metadataId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","statements":[]},{"class":"TargetMatchNode","id":"7e776849-1057-36cf-a1f5-e45dd8a05343","inputNode":"195a4420-d2f9-3557-ba26-69c3f585e1fa","metadataId":"e51688ff-1dc9-4b6c-bb36-8af64d02e9d1","targets":[]},{"@class":"DataStreamFooter","digest":"itzp/jzsenkHcAFIwJMLly0bOgnN6alK7OGxzfYr26Q="}]